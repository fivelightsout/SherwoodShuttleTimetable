<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>豫豐花園接駁巴士時間</title>
  <style>
    * { box-sizing: border-box; }
    body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Helvetica Neue", Arial, sans-serif; background-color: #f0f2f5; color: #333; display: flex; justify-content: center; padding: 20px; }
    .container { max-width: 800px; width: 100%; }
    h1 { text-align: center; margin-bottom: 10px; font-size: 2rem; }
    .current-time { text-align: center; font-size: 1.25rem; margin-bottom: 20px; }
    .schedule-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: 16px; }
    .card { background: #fff; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); padding: 16px; }
    .card h2 { margin: 0 0 12px; font-size: 1.1rem; text-align: center; line-height: 1.4; }
    .times { display: flex; flex-direction: column; align-items: center; }
    .times .prev, .times .next1, .times .next2 { width: 100%; text-align: center; margin: 4px 0; }
    .label { font-size: 0.85rem; color: #777; margin-bottom: 2px; }
    .times .prev span { font-size: 1rem; color: #555; }
    .times .next1 span { font-size: 1.5rem; font-weight: bold; color: #0070f3; }
    .times .next2 span { font-size: 1.2rem; color: #0070f3; }
  </style>
</head>
<body>
  <div class="container">
    <h1>豫豐花園接駁巴士時間</h1>
    <div id="currentTime" class="current-time">載入中…</div>
    <div id="shuttleResults" class="schedule-grid"></div>
  </div>

  <script>
    // --- fully embedded updated schedule data ---
    const shuttleSchedule = {
      "NR762 (豫豐花園 ↔ 兆康站)": {
        "往": [
          "06:15","06:30","06:45","07:00","07:15","07:30","07:45","08:00","08:15","08:30","08:45","09:00","10:05","10:20","10:40","11:00","11:20","11:40","12:00","14:05","14:20","14:40","15:00","15:20","15:40","16:00","18:15","18:30","18:45","19:00","19:15","19:30","19:45","21:15","21:45","22:00"
        ],
        "返": [
          "06:20","06:35","06:50","07:05","07:20","07:35","07:50","08:05","08:20","08:35","08:50","09:05","10:10","10:25","10:45","10:50","11:05","11:25","11:45","12:05","14:10","14:25","14:45","15:05","15:25","15:45","16:05","18:20","18:35","18:50","19:05","19:20","19:35","19:50","21:20","21:35","22:05"
        ]
      },
      "NR762A (豫豐花園 ↔ 屯門市中心)": {
        "往": [
          "07:30","08:00","08:30","09:00","09:15","09:30","09:45","10:00","10:30","11:00","11:30","12:00","12:15","12:30","12:45","13:00","13:15","13:30","13:45","14:00","14:30","15:00","15:30","16:00","16:15","16:30","16:45","17:00","17:15","17:30","17:45","18:00","19:30","20:00","20:15","20:30","20:45","21:00","21:30","22:00","22:15","22:30","22:45","23:00","23:15"
        ],
        "返": [
          "07:40","08:10","08:40","09:10","09:25","09:40","09:55","10:10","10:40","11:10","11:40","12:10","12:25","12:40","12:55","13:10","13:25","13:40","13:55","14:10","14:40","15:10","15:40","16:10","16:25","16:40","16:55","17:10","17:25","17:40","17:55","18:10","19:40","20:10","20:25","20:40","20:55","21:10","21:40","22:10","22:25","22:40","22:55","23:10","23:30"
        ]
      }
    };

    function pad(n) { return n.toString().padStart(2, '0'); }
    function updateCurrentTime() {
      const now = new Date();
      document.getElementById('currentTime').textContent = `現在時間：${pad(now.getHours())}:${pad(now.getMinutes())}`;
    }

    function getNearby(times) {
      const now = new Date();
      const dtList = times.map(t => { const [h, m] = t.split(':'); const d = new Date(); d.setHours(+h, +m, 0, 0); return d; });
      let idx = dtList.findIndex(d => d > now);
      if (idx === -1) idx = dtList.length;
      const prev = idx > 0 ? times[idx - 1] : '--:--';
      const next = times.slice(idx, idx + 2);
      while (next.length < 2) next.push('--:--');
      return { prev, next1: next[0], next2: next[1] };
    }

    function updateSchedule() {
      const container = document.getElementById('shuttleResults');
      container.innerHTML = '';
      for (const route in shuttleSchedule) {
        const [, code, a, b] = route.match(/(\w+).*?\((.*?) ↔ (.*?)\)/);
        for (const dir in shuttleSchedule[route]) {
          const { prev, next1, next2 } = getNearby(shuttleSchedule[route][dir]);
          const fromTo = dir === '往' ? `${a} ➡️ ${b}` : `${b} ➡️ ${a}`;
          const card = document.createElement('div'); card.className = 'card';
          card.innerHTML = `<h2>${code}<br>${fromTo}</h2>
            <div class="times">
              <div class="prev"><div class="label">上一班</div><span>${prev}</span></div>
              <div class="next1"><div class="label">下一班</div><span>${next1}</span></div>
              <div class="next2"><div class="label">再下一班</div><span>${next2}</span></div>
            </div>`;
          container.appendChild(card);
        }
      }
    }

    function refreshAll() {
      updateCurrentTime();
      updateSchedule();
    }

    window.onload = () => {
      refreshAll();
      setInterval(refreshAll, 60000);
    };
  </script>
</body>
</html>
